# 要件

components/templates/ReviewTemplate/ReviewTemplate.tsx

---

## 機能要件

本実装はモックアップ完成を目的とする。
外部API接続は行わない。

---

### 1. 上部サマリー表示（モック算出）

表示項目：

- 未返信口コミ数
- 総合評価（★画像＋数値）
- 返信率（%）
- 平均返信時間（時間）

算出方法：

- すべてモックデータから算出
- 平均返信時間は固定値（例：10.4時間）としてよい

---

### 2. フィルター機能

種別：

- 全て
- 返信済み
- 未返信

仕様：

- 画面内ポップオーバー表示
- 背景暗転なし
- 選択時にリストを再描画
- 他モーダルと同時表示しない

---

### 3. 並び順

種別：

- 返信推奨順
- 新しい順
- 古い順
- 評価の高い順
- 評価の低い順

仕様：

- 画面内ポップオーバー表示
- ローカルデータを並び替える

返信推奨順ロジック（モック固定）：

1. 未返信を上位
2. 評価の低い順
3. 投稿日が新しい順

---

### 4. 口コミリスト表示

表示内容：

- ユーザー名
- 投稿日
- 評価（画像表示）
- コメント冒頭（2行まで）
- ステータスタグ（未返信：赤 / 返信済み：緑）

評価表示仕様：

- rating は 1〜5 の整数のみ
- 小数は扱わない
- 表示は画像で行う

使用画像：
test/mock/rate/
- rate1st.png
- rate2nd.png
- rate3rd.png
- rate4th.png
- rate5th.png

一覧・詳細で同一画像を使用する

---

### 5. 口コミ詳細モーダル

- フルスクリーンモーダル
- 背景暗転あり
- 閉じるボタンあり

表示内容：

- ユーザー名
- 投稿日
- 評価画像
- コメント全文
- 画像一覧（横スクロール可）

---

### 6. 画像タップ

- ルート遷移とする（例：/review/image/[id]）
- モーダルは使用しない
- ブラウザバックで口コミ詳細へ戻る

---

### 7. 返信機能（モック）

口コミ詳細内に返信入力欄を表示。

機能：

- テキスト入力
- 下書き保存（ローカルstate保持）
- 「返信を投稿する」ボタン

投稿仕様：

- ローカルデータの replyStatus を 'replied' に変更
- replyText を保存
- 投稿後は一覧に戻る
- ステータス表示を即時更新

---

## 非機能要件

### UI

- 見た目は docs/figma/review*.svg に一致させる
- モーダル表示時は背景半透明暗転
- モーダル内部はスクロール可能
- モーダル多重ネストは禁止

---

## データ仕様（モック）

```ts
type Review = {
  id: string
  userName: string
  rating: 1 | 2 | 3 | 4 | 5
  comment: string
  images: string[]
  createdAt: string
  replyStatus: 'replied' | 'unreplied'
  replyText?: string
  replyCreatedAt?: string
}
```

データは test/mock/reviewMock.ts に定義する。
- モック口コミ件数は12件固定とする

### 口コミリスト表示（追記）

- ページングは実装しない
- 無限スクロールは実装しない
- すべてのモックデータを一括表示する

### 口コミ詳細内の画像表示仕様

- 画像は最大3枚まで横並びで表示する
- 4枚以上ある場合は、3枚目の右下に「+X枚」と表示する
  （X = 総枚数 - 3）
- 画像をタップすると画像単体画面へ遷移する
- モックデータには画像3枚以上の口コミを含める

### デモ安定仕様

- モックデータは固定値とする（ランダム生成禁止）
- ページリロードで初期状態に戻る
- エラー状態は実装しない
- ローディング表示は実装しない

- 返信投稿後は口コミ詳細モーダルを閉じる
- 一覧表示で即時ステータス更新を反映する

### 口コミ画像仕様

使用画像ディレクトリ：
test/mock/shop-review/

- 画像は上記ディレクトリ内のファイルのみ使用する
- 外部画像URLは使用しない

画像構成：

- モック口コミ総数は12件固定
- 画像なしの口コミを含める
- 画像1枚の口コミを含める
- 画像3枚の口コミを含める
- 画像4枚以上の口コミを含める

4枚以上ある場合：
- 画面上は最大3枚まで表示
- 3枚目右下に「+X枚」と表示する
