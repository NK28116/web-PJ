# プロジェクトタスク & 調査報告

## 表示順の画面機能 (User Flow & UI Transitions)

正常系における時系列順の動作と表示の変化を以下に定義します。

### 1. アプリケーション起動 (未認証状態)
1. **ユーザー操作**: ブラウザのアドレスバーにアプリのURL (例: `/home`, `/report` 等) を入力してアクセスする。
2. **内部処理**: `AuthGuard` が実行され、`localStorage` 内の `auth_token` を確認する -> **存在しない**。
3. **表示変化**: **ログイン画面 (`/`)** が強制的に表示される。
   - 背景: 黒ベース (`#1A1A1A`)。
   - コンテンツ: フォーム（メール、パスワード）、「ログイン」ボタン、「新規でアカウント登録」ボタン。

### 2. 新規登録 (サインアップ) フロー
1. **ユーザー操作**: ログイン画面の「新規でアカウント登録」ボタンを押下。
2. **表示変化**: **サインアップ画面 (Step 1)** へ遷移。
   - `StepIndicator`: 「1」がアクティブ。
   - コンテンツ: 各種登録ボタン一覧。
    - planBサービスでは各種SNSでのログインを想定していたがwyzeでは必要ない
    - ここには開発用の「ログイン正常系」，「ログイン時メールアドレス異常」，「ログイン時パスワード異常」などログイン時に各種テストケースを実行するボタンを作成する
3. **ユーザー操作**: 「メールアドレスで登録」を選択し、必要情報（名前、メール、パス、生年月日等）を入力して「次へ」を押下。
4. **表示変化**: **サインアップ画面 (Step 3)** へ切り替わる。
   - `StepIndicator`: 「3」がアクティブ。
   - コンテンツ: 「登録が完了しました」メッセージ。
5. **ユーザー操作**: 「ホームへ移動」ボタンを押下。
6. **内部処理**: `localStorage` に `auth_token` を保存。
7. **表示変化**: **ホーム画面 (`/home`)** へ遷移する。

### 3. ログインフロー
1. **ユーザー操作**: ログイン画面でメールアドレスとパスワードを入力し、「ログイン」ボタンを押下。
2. **内部処理**: バリデーション後、`localStorage` に `auth_token` を保存。
3. **表示変化**: **ホーム画面 (`/home`)** へ遷移する。

### 4. ログアウトフロー
1. **ユーザー操作**: メニューから「ログアウト」を選択。
2. **表示変化**: **ログアウト確認モーダル** が表示される。
3. **ユーザー操作**: モーダル内で「ログアウト」ボタンを押下。
4. **内部処理**: `localStorage` から `auth_token` を削除。
5. **表示変化**: 即座に **ログイン画面 (`/`)** へ遷移する。

---

## 1. 認証機能の実装 (Authentication)

### 1.1 調査報告: `stash/Login` の再構築
- **依存関係の排除**:
    - `react-native`, `expo-router`, `firebase/auth`, `expo-font` への依存を全て削除する。
- **UIコンポーネントの変換**:
    - `View` -> `div`
    - `Text` -> `p`, `span`, `h1`
    - `TextInput` -> `input` (Tailwindで装飾)
    - `TouchableOpacity` -> `button`
- **サインアップ特有のコンポーネント**:
    - `StepIndicator`: Tailwind CSS を用いたステップバー（現在のステップを視覚化）へ再構築。
    - `CustomWheelPicker` (`AreaPicker`, `BirthDayPicker`): Web 標準の `select` 要素、または直感的なボタン選択/入力フォームへ置換。
- **ロジックの変更**:
    - `signInWithEmailAndPassword` を `localStorage.setItem` を用いたモック処理へ置換。
    - サインアップの各ステップ管理は React のローカル State または Context で維持。

### 1.2 タスクリスト
- [ ] **認証ガードの実装**
  - [ ] `AuthGuard` コンポーネントの作成（セッション確認ロジック）
  - [ ] `pages/_app.tsx` への組み込み
- [ ] **ログイン画面の再構築 (`LoginTemplate`)**
  - [ ] `stash/Login/auth/login.tsx` を Next.js 向けに移植
  - [ ] `docs/figma/login.svg` に基づくスタイリング
- [ ] **サインアップ画面の再構築 (`SignUpTemplate`)**
  - [ ] `StepIndicator` の Web 版実装
  - [ ] ピッカーコンポーネントを Web 標準要素へ置換
  - [ ] 各ステップ（方法選択、メール認証、完了）の移植
- [ ] **ログアウト機能の実装**
  - [ ] `LogoutModal` の作成 (`docs/figma/logoutModal.svg` 準拠)
  - [ ] ログアウト時のセッションクリア処理
- [ ] **スタイルの変更**
  - [ ] Wyzeで主に使われているのは背景が白ベースでprimaryが`#00A48D`
  - [ ] 最終的なUIの調整で変更しやすい様にどこで使われているのかをコメントアウトしておく
