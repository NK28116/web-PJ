# 設計書 (Design Document)

## 1. ホームタブ設計

### 1.1 レイアウト基本方針
- **Figma準拠**: Figmaのデザインを唯一の正（Source of Truth）とし、レイアウト、セクション構造、要素配置を完全に一致させる。
- **セクション構造**: 
  - ダッシュボード全体を独立したセクションの集合体として構成する。
  - 各セクション（AIアクション、システム状況、集計指標等）は視覚的に独立した「塊」として表現する。

### 1.2 ダッシュボード構成要素
- **AIによる最優先アクション**:
  - セクションとして独立させ、他の情報より視覚的優先度を高く設定する。
  - 情報が空（0件）の場合でもセクション枠は維持し、適切な空状態（Empty State）を表示する。
- **システム稼働状況・集計指標**:
  - 本日の検索数等の指標をセクション単位で表示する。
  - 単なるテキストの羅列を避け、Figmaで定義されたカード型やブロック型のUIを採用する。
- **更新操作**:
  - ダッシュボード全体を更新する操作であることを視覚的に明示する。

### 1.3 アカウント連携（疑似連携）
- **UI構造**:
  - 「アカウント連携」という単一のカテゴリ内に、Google、Instagram等の各サービスをまとめて表示する。
  - サービスごとに別カテゴリとして分けることは禁止とする。
- **操作性**:
  - 各サービスの連携状態（未連携/連携済み）をスイッチ（トグル）形式で切り替え可能にする。
  - スイッチ操作により即座に内部状態を更新し、ホームタブ全体の表示に反映させる。
- **拡張性**:
  - UI層に連携ロジックを直接埋め込まず、状態管理層を介して処理する。
  - 将来的な実際のOAuth連携（Google Business Profile API / Instagram Graph API）への差し替えが容易なインターフェース設計を行う。

### 1.4 店舗一覧
- **表示形式**: 
  - 各店舗をカード単位でリスト表示する。
- **ステータス表示**:
  - 「連携待ち」などの店舗状態を、カード内の店舗情報に付随する形で明確に表示する。
- **配置**:
  - ホームタブの主要な要素の一つとして、適切な重み付け（サイズ・位置）で配置する。

## 2. 投稿タブ設計

### 2.1 レイアウト基本方針
- **Figma準拠**: 投稿一覧、詳細モーダル共にFigmaのデザインを正とする。
- **画面構成**:
  - ヘッダー（ロゴ、メニュー）は常時表示。
  - タブナビゲーション（ホーム、投稿、レポート、自動返信）により画面遷移。

### 2.2 投稿一覧機能
- **表示形式**: 
  - グリッド表示（正方形カード、サムネイルメイン）とリスト表示（縦並び、詳細情報含む）の2形式を持つ。
  - 即時切替可能で、現在の選択状態を視覚的に明示する。
- **フィルタ・ソート**:
  - **件数表示**: 現在の表示件数を常に表示する。
  - **並び順**: モーダル/ボトムシートによる選択（投稿日、集客効果、いいね数、コメント数、アクセス数）。
  - **非表示フィルタ**: 「非表示」ボタンにより、非表示ステータスの投稿の表示/非表示を切り替える。

### 2.3 投稿アイテム
- **グリッド時**: サムネイル画像、ステータス（表示中/非表示）を表示。
- **リスト時**: サムネイル、タイトル、指標情報（集客誘導率等）を表示。

### 2.4 投稿詳細（モーダル）
- **表示形式**: 一覧からのタップでモーダル展開（背景オーバーレイ）。
- **情報構成**:
  - ヘッダー部：ユーザー情報、ステータスバッジ（表示中/非表示）、閉じるボタン。
  - コンテンツ部：画像、NEWラベル、タイトル、本文、投稿日時、タグ。
  - 指標部：集客誘導率などを数値とバーで可視化。
- **アクション**:
  - 「投稿を編集」ボタン。
  - ステータス切替ボタン（「非表示にする」/「表示する」）。

### 2.5 状態管理
- **ステータス**: 「表示中」と「非表示」の2状態を管理。
- **データ連携**: 現段階ではローカルステートまたはダミーデータを使用し、即時UI反映を実現する（実API連携は対象外）。

## 3. レポートタブ設計

### 3.1 レイアウト基本方針
- **Figma準拠**: レポートタブのデザインはFigma定義（`docs/figma/report.png`）を正とする。
- **画面構成**:
  - ヘッダー（ロゴ、メニュー）、タブナビゲーションは他タブと共通。
  - メインコンテンツエリアにレポート内容を表示。

### 3.2 レポート表示機能
- **期間切り替え**:
  - 表示対象期間を切り替えるUI（ドロップダウンまたはボタン列）を配置する。
  - 選択肢（案）：直近7日間、直近30日間、先月。
  - 切り替え操作により、画面内の全指標・グラフを連動して更新する。

- **サマリー指標表示**:
  - 以下の4指標をカード形式で表示する。
    1. **総合プロフィール閲覧数**
    2. **総合アクション数**
    3. **来店誘導率**
    4. **口コミ平均評価**
  - 各カードの構成要素:
    - 指標名
    - 現在の値（強調表示）
    - 前期間比（％表示）および増減方向を示すアイコン（↑/↓）。

- **内訳・構成比表示**:
  - 以下の項目を**ドーナツグラフ（円グラフ）**で表示する。
    1. **総合アクション内訳**
    2. **媒体別内訳**（Google, Instagram, Webサービス）
  - 凡例（Legend）を併記し、色と項目名の対応を明確にする。

- **傾向・推移表示**:
  - **曜日・時間帯別傾向**: 棒グラフまたはヒートマップ形式を採用し、混雑傾向等を可視化する。
  - **MEO順位推移**: 折れ線グラフを使用し、順位の変動（時系列）を表示する。

- **データ未提供時の表示**:
  - データが存在しない期間や項目については「COMING SOON」またはプレースホルダーを表示する。
  - アプリケーションがクラッシュしないよう、nullチェックを徹底する。

### 3.3 コンポーネント設計
- **グラフコンポーネント**: 
  - `recharts` 等の軽量ライブラリ、またはSVG/CSSでの実装を推奨。
  - スマートフォン表示に最適化し、ラベルの重なり等を防ぐレスポンシブ対応を行う。
- **コンポーネント分割**:
  - `PeriodSelector` (期間選択)
  - `SummaryCard` (指標カード)
  - `BreakdownChart` (内訳グラフ)
  - `TrendChart` (推移グラフ)
  - これらを `components/organisms/Report/` 配下に配置し、再利用性と保守性を高める。

## 4. UI/UX 設計方針

### 2.1 ナビゲーション
- **領域分離**: ヘッダー・タブ（ナビゲーション領域）とコンテンツ（本文領域）を明確に分離する。
- **スクロール体験**: スクロール中も現在のセクションが把握しやすいよう、視覚的な区切りを明確にする。

### 2.2 操作性とフィードバック
- **クリック/タップ領域**: タップ可能な要素を色、形状、配置により明確に判別可能にする。
- **影響範囲の明確化**: 操作（例：連携スイッチの切り替え）がどこに影響を及ぼすかを視覚的に一致させる。

### 2.3 状態の視覚表現
- **構造的差異**: 状態の変化（例：未連携から連携済みへ）を、文言の変更だけでなく、レイアウトや構造の微妙な変化を伴う表現として実装する。
- **同一レイアウトの使い回し禁止**: 内容が変わる際は、単なるテキスト置換ではなく、状態に応じた適切な構造（コンポーネントの切り替え等）を用いる。
